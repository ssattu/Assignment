Questions
1. The following relations keep track of airline flight information:
Flights(flno: integer, from: string, to: string, distance: integer, departs:
time,
arrives: time, price: integer)
Aircraft(aid: integer, aname: string, cruisingrange: integer)
Certified(eid: integer, aid: integer)
Employees(eid: integer, ename: string, salary: integer)

Note that the Employees relation describes pilots and other kinds of employees
aswell; every pilot is certified for some aircraft, and only pilots are certified to
fly.Write each of the following queries in SQL.


a. Find the names of aircraft such that all pilots certified to operate them earn more than $10,00,000.
sol. airlines=# select a_name from aircraft join certified using (a_id) join employees using (e_id) where salary>10,00,000;
  a_name   
-----------
 indigo
 indigo
 airlindia
 airlindia
 airlindia
(5 rows)


b. For each pilot who is certified for more than one aircraft, find the eid and the
maximum cruisingrange of the aircraft for which she or he is certified.
sol.  airlines=# select e_id, max(cruisingrange) from employees join certified using (e_id) join aircraft using (a_id) group by e_id having count(e_id) >1;
 e_id | max  
------+------
  107 | 3500
  101 | 4000
  109 | 3500
  106 | 3500
  100 | 4000
(5 rows)
